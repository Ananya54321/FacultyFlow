<% layout("/layouts/boilerplate")-%>

<div class="container mt-4">
  <div class="row">
    <div class="col-md-8">
      <h2 class="mb-3" style="color: #182527; font-weight: 600">
        <%= dept.deptcode %> Announcements
      </h2>

      <% if (announcements && announcements.messages.length > 0) { %>
      <div class="card mb-4" style="border-color: #1ecd8d">
        <div class="card-body p-0">
          <ul class="list-group list-group-flush">
            <% for (let j = 0; j < announcements.messages.length; j++) { %>
            <li
              class="list-group-item"
              style="border-bottom: 1px solid #e9ecef">
              <div class="d-flex justify-content-between align-items-center">
                <strong style="color: #182527"
                  ><%= announcements.messages[j].displayname %></strong
                >
                <small class="text-muted"
                  >Posted on: <%= new Date().toLocaleDateString() %></small
                >
              </div>
              <p class="mb-0 mt-2" style="color: #545454">
                <%= announcements.messages[j].msg %>
              </p>
            </li>
            <% } %>
          </ul>
        </div>
      </div>
      <% } else { %>
      <div
        class="alert alert-info"
        role="alert"
        style="
          background-color: #e8f8f2;
          color: #182527;
          border-color: #1ecd8d;
        ">
        No announcements available at this time.
      </div>
      <% } %>
    </div>

    <div class="col-md-4">
      <div class="card" style="border-color: #1ecd8d">
        <div
          class="card-header bg-light"
          style="border-bottom: 2px solid #1ecd8d">
          <h5 class="card-title mb-0" style="color: #182527">
            Post New Announcement
          </h5>
        </div>
        <div class="card-body">
          <form
            action="/departments/<%= dept._id %>/announcements"
            method="post">
            <div class="mb-3">
              <label for="msg" class="form-label" style="color: #545454"
                >Message:</label
              >
              <textarea
                class="form-control"
                name="msg"
                id="msg"
                rows="3"
                required
                style="border-color: #ced4da"
                placeholder="Type your announcement here..."></textarea>
            </div>
            <button
              type="submit"
              class="btn btn-primary w-100"
              style="background-color: #1ecd8d; border-color: #1ecd8d">
              Submit
            </button>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>

<style>
  .list-group-item:last-child {
    border-bottom: none !important;
  }
  .btn-primary:hover {
    background-color: #15a06e !important;
    border-color: #15a06e !important;
  }
</style>
